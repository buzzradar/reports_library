<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="   sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,800&display=swap" rel="stylesheet">

    <link href="css/report-AA-SocialIntel-audience-vs-content.css" rel="stylesheet">

    <title>Buzz Radar Reports Page</title>

  </head>

  <body>

    <div id="report_slide" class="report-aa-socialintel-audience-vs-content" style="top:{{slideTop}}px;">

      <div class="slide-background">
        
        <div class="bubbles">
          <div class="b-top"></div>
          <div class="b-middle"></div>
          <div class="b-bottom"></div>
        </div>
        <div class="left-bar orange"></div>
        <div class="right-bar orange"></div>
        <div class="vertical"></div>

      </div>

      <div class="slide">
          
          <div class="report_title">
              <div class="top">{{report.name}}</div>
              <div class="bottom">{{topic.name}}: Audience Comparison with Content</div>
          </div>

          <div class="content">


            <div class="main-layout-wrap">
              <div class="col1">
                <div class="col_title">Audience Overview</div>
                <div id="gauge1_graph" class="graph_wrap" style="height:580px;"></div>
              </div>
              <div class="col2">
                <div class="col_title">Content Overview</div>
                <div id="gauge2_graph" class="graph_wrap" style="height:580px;"></div>
              </div>
              <div class="col3">
                <div class="col_title">Content Audience Match</div>
                <div id="metric_graph" class="graph_wrap" style="height:580px;"></div>
              </div>
            </div>

          </div>


      </div>

      <div class="footer">
          <div class="date-range">Date Range: {{fromDate | date('jS M Y') }} - {{ toDate | date('jS M Y') }}</div>
          <img src="https://3c90f21d2e52d99af65d-cc7a500d9b10d65e67a8ddf30b9c21f5.ssl.cf3.rackcdn.com/reports_imgs/logos/RGB_NAME_WHITEBG_SMALL72.png" width="200">
      </div>

    </div>





    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
    <script src="https://www.amcharts.com/lib/3/gauge.js"></script>


    <script>

      var AASocialIntelAudienceContentInstance = function () {

        var pageDataJS = {"audienceAnalyserVsContent":{"audience":{"personality_name":"Architect","personality_description":"You are a bit coarse, somewhat insensitive and informal.\nYou are unconcerned with art: you are less concerned with artistic or creative activities than most people who participated in our surveys. You are dispassionate: you do not frequently think about or openly express your emotions. And you are contrary: you do not shy away from contradicting others.\nYour choices are driven by a desire for efficiency.\nYou consider taking pleasure in life to guide a large part of what you do: you are highly motivated to enjoy life to its fullest. You are relatively unconcerned with tradition: you care more about making your own path than following what others have done.","fullname":"","avatar":"","watson_profile":{"personality":[{"name":"Openness","percentile":0,"children":[{"name":"Adventurousness","percentile":0.48},{"name":"Artistic interests","percentile":0},{"name":"Emotionality","percentile":0.02},{"name":"Imagination","percentile":0.41},{"name":"Intellect","percentile":0.58},{"name":"Authority-challenging","percentile":0.62}]},{"name":"Conscientiousness","percentile":0.12,"children":[{"name":"Achievement striving","percentile":0.33},{"name":"Cautiousness","percentile":0.19},{"name":"Dutifulness","percentile":0.05},{"name":"Orderliness","percentile":0.1},{"name":"Self-discipline","percentile":0.43},{"name":"Self-efficacy","percentile":0.93}]},{"name":"Extraversion","percentile":0.61,"children":[{"name":"Activity level","percentile":0.55},{"name":"Assertiveness","percentile":0.79},{"name":"Cheerfulness","percentile":0.18},{"name":"Excitement-seeking","percentile":0.85},{"name":"Outgoing","percentile":0.38},{"name":"Gregariousness","percentile":0.36}]},{"name":"Agreeableness","percentile":0,"children":[{"name":"Altruism","percentile":0.05},{"name":"Cooperation","percentile":0.02},{"name":"Modesty","percentile":0.08},{"name":"Uncompromising","percentile":0.06},{"name":"Sympathy","percentile":0.21},{"name":"Trust","percentile":0.1}]},{"name":"Emotional range","percentile":0.03,"children":[{"name":"Fiery","percentile":0.77},{"name":"Prone to worry","percentile":0.56},{"name":"Melancholy","percentile":0.76},{"name":"Immoderation","percentile":0.43},{"name":"Self-consciousness","percentile":0.67},{"name":"Susceptible to stress","percentile":0.42}]},{"name":"Needs","percentile":0.5,"children":[{"name":"Challenge","percentile":0.73},{"name":"Closeness","percentile":0.02},{"name":"Curiosity","percentile":0.09},{"name":"Excitement","percentile":0.73},{"name":"Harmony","percentile":0.1},{"name":"Ideal","percentile":0.72},{"name":"Liberty","percentile":0.94},{"name":"Love","percentile":0.06},{"name":"Practicality","percentile":0.99},{"name":"Self-expression","percentile":0.11},{"name":"Stability","percentile":0.24},{"name":"Structure","percentile":0.91}]},{"name":"Values","percentile":0.5,"children":[{"name":"Conservation","percentile":0.15},{"name":"Openness to change","percentile":0.3},{"name":"Hedonism","percentile":0.85},{"name":"Self-enhancement","percentile":0.79},{"name":"Self-transcendence","percentile":0.35}]}],"needs":[{"name":"Challenge","percentile":0.73},{"name":"Closeness","percentile":0.02},{"name":"Curiosity","percentile":0.09},{"name":"Excitement","percentile":0.73},{"name":"Harmony","percentile":0.1},{"name":"Ideal","percentile":0.72},{"name":"Liberty","percentile":0.94},{"name":"Love","percentile":0.06},{"name":"Practicality","percentile":0.99},{"name":"Self-expression","percentile":0.11},{"name":"Stability","percentile":0.24},{"name":"Structure","percentile":0.91}],"values":[{"name":"Conservation","percentile":0.15},{"name":"Openness to change","percentile":0.3},{"name":"Hedonism","percentile":0.85},{"name":"Self-enhancement","percentile":0.79},{"name":"Self-transcendence","percentile":0.35}]}},"content":{"personality_name":"Commander","personality_description":"You are rational and somewhat insensitive.\nYou are adventurous: you are eager to experience new things. You are self-assured: you tend to feel calm and self-assured. And you are mild-tempered: it takes a lot to get you angry.\nYou are motivated to seek out experiences that provide a strong feeling of organization.\nYou are relatively unconcerned with helping others: you think people can handle their own business without interference. You don't find taking pleasure in life to be particularly motivating for you: you prefer activities with a purpose greater than just personal enjoyment.","fullname":"","avatar":"","watson_profile":{"personality":[{"name":"Openness","percentile":0.6,"children":[{"name":"Adventurousness","percentile":0.89},{"name":"Artistic interests","percentile":0.37},{"name":"Emotionality","percentile":0.27},{"name":"Imagination","percentile":0.27},{"name":"Intellect","percentile":0.65},{"name":"Authority-challenging","percentile":0.62}]},{"name":"Conscientiousness","percentile":0.94,"children":[{"name":"Achievement striving","percentile":0.74},{"name":"Cautiousness","percentile":0.83},{"name":"Dutifulness","percentile":0.68},{"name":"Orderliness","percentile":0.66},{"name":"Self-discipline","percentile":0.77},{"name":"Self-efficacy","percentile":0.53}]},{"name":"Extraversion","percentile":0.67,"children":[{"name":"Activity level","percentile":0.78},{"name":"Assertiveness","percentile":0.83},{"name":"Cheerfulness","percentile":0.45},{"name":"Excitement-seeking","percentile":0.31},{"name":"Outgoing","percentile":0.74},{"name":"Gregariousness","percentile":0.75}]},{"name":"Agreeableness","percentile":0.18,"children":[{"name":"Altruism","percentile":0.73},{"name":"Cooperation","percentile":0.7},{"name":"Modesty","percentile":0.74},{"name":"Uncompromising","percentile":0.74},{"name":"Sympathy","percentile":0.51},{"name":"Trust","percentile":0.81}]},{"name":"Emotional range","percentile":0.13,"children":[{"name":"Fiery","percentile":0.14},{"name":"Prone to worry","percentile":0.1},{"name":"Melancholy","percentile":0.26},{"name":"Immoderation","percentile":0.27},{"name":"Self-consciousness","percentile":0.22},{"name":"Susceptible to stress","percentile":0.16}]},{"name":"Needs","percentile":0.5,"children":[{"name":"Challenge","percentile":0.59},{"name":"Closeness","percentile":0.08},{"name":"Curiosity","percentile":0.33},{"name":"Excitement","percentile":0.59},{"name":"Harmony","percentile":0.07},{"name":"Ideal","percentile":0.49},{"name":"Liberty","percentile":0.57},{"name":"Love","percentile":0.1},{"name":"Practicality","percentile":0.49},{"name":"Self-expression","percentile":0.32},{"name":"Stability","percentile":0.39},{"name":"Structure","percentile":0.68}]},{"name":"Values","percentile":0.5,"children":[{"name":"Conservation","percentile":0.46},{"name":"Openness to change","percentile":0.31},{"name":"Hedonism","percentile":0.25},{"name":"Self-enhancement","percentile":0.68},{"name":"Self-transcendence","percentile":0.22}]}],"needs":[{"name":"Challenge","percentile":0.59},{"name":"Closeness","percentile":0.08},{"name":"Curiosity","percentile":0.33},{"name":"Excitement","percentile":0.59},{"name":"Harmony","percentile":0.07},{"name":"Ideal","percentile":0.49},{"name":"Liberty","percentile":0.57},{"name":"Love","percentile":0.1},{"name":"Practicality","percentile":0.49},{"name":"Self-expression","percentile":0.32},{"name":"Stability","percentile":0.39},{"name":"Structure","percentile":0.68}],"values":[{"name":"Conservation","percentile":0.46},{"name":"Openness to change","percentile":0.31},{"name":"Hedonism","percentile":0.25},{"name":"Self-enhancement","percentile":0.68},{"name":"Self-transcendence","percentile":0.22}]}}}};


        var pageId = '';
        var slideDom = $('#report_slide'+pageId);
        var custom = {
              color : '#8ebf6a',
              vendorLogoURL : 'https://3c90f21d2e52d99af65d-cc7a500d9b10d65e67a8ddf30b9c21f5.ssl.cf3.rackcdn.com/reports_imgs/bg/buzzradar_logo_reports.png',
              bgURL : 'https://3c90f21d2e52d99af65d-cc7a500d9b10d65e67a8ddf30b9c21f5.ssl.cf3.rackcdn.com/reports_imgs/bg/br_reports_bg.jpg',
        };
        console.log("Unique Page ID:", "report_slide"+pageId);
        console.log(pageDataJS);
        var gaugeChart;

        var loadPersonalityOverviewGraph = function(graphID, personalityBreakdownData){



            if (personalityBreakdownData.length == 0) {
              slideDom.find('#'+graphID).html('<div class="no-data">There is no data to display this graph.</div>');
              return false;
            }

            personalityBreakdownData = personalityBreakdownData.watson_profile.personality;

            //-----------------------------------------------------------------------
            //DEVELOPER NOTE!
            //We need to include Needs and Values.
            // this.personality_MO = _addNeedsValues(this.personality_MO);
            //-----------------------------------------------------------------------

            var colorArray = ['#84b761','#fdd400','#cc4748','#67b7dc','#ffaf30','#d88fe8','#bfc442'];
            var bands = [];
            var allLabels = [];
            var bandValue = 100;
            var startY = 3;

            $.each(personalityBreakdownData, function( index, value ) {

                var radius = bandValue;
                var innerRadius = bandValue - 8;

                bands.push({
                  "color": "#eee",
                  "startValue": 0,
                  "endValue": 100,
                  "radius": radius + "%",
                  "innerRadius": innerRadius +"%",
                  "title" : value.name,
                  "dataChild" : value,
                  "colorBandClick" : colorArray[index],
                }, {
                  "color": colorArray[index],
                  "startValue": 0,
                  "endValue": (value.percentile * 100).toFixed(0),
                  "radius": radius+"%",
                  "innerRadius": innerRadius+"%",
                  "balloonText": (value.percentile * 100).toFixed(0) + "%",
                  "title" : value.name,
                  "colorBandClick" : colorArray[index],
                  "dataChild" : value,
                });

                bandValue -= 13;

                allLabels.push({
                  "text": value.name,
                  "x": "49%",
                  "y": startY+"%",
                  "size": 15,
                  "bold": true,
                  "color": colorArray[index],
                  "align": "right"
                });

                startY += 6;

            });

            AmCharts.makeChart(slideDom.find('#'+graphID).get(0), {
                "type": "gauge",
                "theme": "none",
                "addClassNames": true,
                "axes": [{
                  "axisAlpha": 0,
                  "tickAlpha": 0,
                  "labelsEnabled": false,
                  "startValue": 0,
                  "endValue": 100,
                  "startAngle": 0,
                  "endAngle": 270,
                  "bands": bands,
                }],
                "allLabels": allLabels,
                "export": {
                  "enabled": false
                }
              });

          };



          var loadContentAudienceMatch = function () {

              var AudiencePersonality = pageDataJS.audienceAnalyserVsContent.audience;
              var ContentPersonality = pageDataJS.audienceAnalyserVsContent.content;

              if (AudiencePersonality && AudiencePersonality.watson_profile && ContentPersonality && ContentPersonality.watson_profile){
                var tempSum = 0;

                for (i = 0; i < ContentPersonality.watson_profile.personality.length; i++) {          
                  tempSum += parseInt(getPersonalityCalculation(ContentPersonality.watson_profile.personality[i].name))
                  if (tempSum > 0 && ContentPersonality.watson_profile.personality.length) {
                    var valToDisplay = (tempSum/ContentPersonality.watson_profile.personality.length).toFixed(0, 10);
                  }



                }


                console.log("valToDisplayComparison--->",valToDisplay);

                if (valToDisplay == undefined) {
                  valToDisplay = 0;
                  slideDom.find('#metric_graph').html('<div class="display_error"><strong>Warning: </strong>The match could not be drawn cause there is no data or the calculation turns "undefined". Check if the data is correct please.</div>');
                }
                
                gaugeChart.arrows[0].setValue(valToDisplay);
                gaugeChart.axes[0].setTopText(valToDisplay + " %");
                gaugeChart.axes[0].bands[1].setEndValue(valToDisplay);

                
                setTimeout(function() {
                  $('path').attr('stroke','transparent');
                  $('path').attr('stroke-opacity','0');
                  $('path').attr('strokeOpacity','0');
                },100);
                
                

                

              }
          };


          var getPersonalityCalculation = function(persName){

            var AudiencePersonality = pageDataJS.audienceAnalyserVsContent.audience;
            var ContentPersonality = pageDataJS.audienceAnalyserVsContent.content;

            if (persName && AudiencePersonality && AudiencePersonality.watson_profile && ContentPersonality && ContentPersonality.watson_profile){          
                //get childrerns for this trait
                for (i = 0; i < ContentPersonality.watson_profile.personality.length; i++) {          
                    if (ContentPersonality.watson_profile.personality[i].name == persName){
                        var dataChild = ContentPersonality.watson_profile.personality[i]
                        var sum = 0;                  
                        $.each(dataChild.children, function( index, value ) {
                            var v1 = getValueForChart(AudiencePersonality, dataChild.name, value.name);
                            var v2 = getValueForChart(ContentPersonality, dataChild.name, value.name);
                            if (v1/v2 > 1) {
                              sum +=  v2/v1
                            } else {
                              sum += v1/v2
                            }
                            //sum += Math.abs(getValueForChart(AudiencePersonality, dataChild.name, value.name) - getValueForChart(ContentPersonality, dataChild.name, value.name))
                            //console.log('one vs other ' + v1 + ' <-->' +  v2)
                        });
                        if (sum > 0) {
                          var value = 100 * (sum/dataChild.children.length)
                          //console.log(value.toFixed(0, 10))
                          return value.toFixed(0, 10)
                        }
                    }
                }
            }
                return 0;
          };


          var getValueForChart = function(profile, category, trait){      
            if (!profile) return 0;
            if (!profile.watson_profile) return 0;
            if (!profile.watson_profile.personality) return 0;

            for (i = 0; i < profile.watson_profile.personality.length; i++) { 
              if (profile.watson_profile.personality[i].name == category){
                for (j = 0; j < profile.watson_profile.personality[i].children.length; j++) { 
                  if (profile.watson_profile.personality[i].children[j].name == trait){
                    return (profile.watson_profile.personality[i].children[j].percentile * 100).toFixed(0);
                  }
                }
              }
            }
            return 0;
          };



        var loadComparisonChart = function() {
          gaugeChart = AmCharts.makeChart(slideDom.find('#metric_graph').get(0), {
            "theme": "none",
            "addClassNames": true,
            "type": "gauge",
            "startDuration" : 0,
            "axes": [{
              "topTextFontSize": 20,
              "topTextYOffset": 70,
              "axisColor": "#31d6ea",
              "axisThickness": 1,
              "endValue": 100,
              "gridInside": true,
              "inside": true,
              "radius": "50%",
              "valueInterval": 10,
              "tickColor": "#67b7dc",
              "startAngle": -90,
              "endAngle": 90,
              "unit": "%",
              "bandOutlineAlpha": 0,
              "bands": [{
                "color": "#ce4d4a",
                "endValue": 100,
                "innerRadius": "105%",
                "radius": "170%",
                "startValue": 0,
                "gradientRatio": [0.2, 0, -0.2],
                "borderAlpha": 0,
              }, {
                "color": "#87bd40",
                "endValue": 0,
                "innerRadius": "105%",
                "radius": "170%",
                "gradientRatio": [0.2, 0, -0.2],
                "borderAlpha": 0,
                "startValue": 0,
              }]
            }],
            "arrows": [{
              "alpha": 1,
              "innerRadius": "35%",
              "nailRadius": 0,
              "radius": "170%"
            }]
          });

          var myInterval = setInterval(function() {
            
            console.log("Hitting Interval.....");
            if (typeof gaugeChart.arrows[0].setValue === "function") { 
              // safe to use the function
              loadContentAudienceMatch();          
              clearInterval(myInterval);  
            }

          },100);


        };


        var customize = function(customObject) {

            //Change Color
            var newColor = customObject.color;
            slideDom.find('.slide-background').find('.left-bar').css('background',newColor);
            slideDom.find('.slide-background').find('.right-bar').css('background',newColor);
            slideDom.find('.report_title').css('borderColor',newColor);

            //Change Vendor Logo
            //Developer Note: To avoid having issues placing the different logos, they must be 
            //created within this dimensions: 300 x 131
            slideDom.find('.footer').find('img').attr('src',customObject.vendorLogoURL);
            slideDom.find('.footer').find('img').css('marginTop',-25);
            slideDom.find('.footer').find('img').css('width',170);

          };


        return {
            init: function () {
              customize(custom);
              
              loadComparisonChart();
              loadPersonalityOverviewGraph('gauge1_graph', pageDataJS.audienceAnalyserVsContent.audience);
              loadPersonalityOverviewGraph('gauge2_graph', pageDataJS.audienceAnalyserVsContent.content);
              
              setTimeout(function() {
                $('path').attr('stroke','transparent');
              },200);


            }
        };
        
      }();

      AASocialIntelAudienceContentInstance.init();
          
    </script>


  </body>
</html>
