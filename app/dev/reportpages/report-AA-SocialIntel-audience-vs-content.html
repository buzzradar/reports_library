<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="   sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,800&display=swap" rel="stylesheet">

    <link href="css/report-AA-SocialIntel-audience-vs-content.css" rel="stylesheet">

    <title>Buzz Radar Reports Page</title>

  </head>

  <body>

    <div id="report_slide" class="report-aa-socialintel-audience-vs-content" style="top:{{slideTop}}px;">

      <div class="slide-background">
        
        <div class="bubbles">
          <div class="b-top"></div>
          <div class="b-middle"></div>
          <div class="b-bottom"></div>
        </div>
        <div class="left-bar orange"></div>
        <div class="right-bar orange"></div>
        <div class="vertical"></div>

      </div>

      <div class="slide">
          
          <div class="report_title">
              <div class="top">Audience Comparison with Content</div>
              <div class="bottom">{{topic.name}}</div>
          </div>

          <div class="content">


            <div class="main-layout-wrap">
              <div class="col1">
                <div class="col_title">Audience Overview</div>
                <div id="gauge1_graph" class="graph_wrap" style="height:580px;"></div>
              </div>
              <div class="col2">
                <div class="col_title">Content Overview</div>
                <div id="gauge2_graph" class="graph_wrap" style="height:580px;"></div>
              </div>
              <div class="col3">
                <div class="col_title">Content Audience Match</div>
                <div id="metric_graph" class="graph_wrap" style="height:580px;"></div>
                <div class="card">
                  <h3>Behind the numbers</h3>
                  <p>On the left, it is interesting to notice that Facebook and Twitter cover 92% of the daily activity of all brands analysed however they contribute to just 4% of the engagement rate.</p>
                </div>
              </div>
            </div>

          </div>


      </div>

      <div class="footer">
          <div class="date-range">Date Range: {{fromDate | date('jS M Y') }} - {{ toDate | date('jS M Y') }}</div>
          <img src="https://3c90f21d2e52d99af65d-cc7a500d9b10d65e67a8ddf30b9c21f5.ssl.cf3.rackcdn.com/reports_imgs/logos/RGB_NAME_WHITEBG_SMALL72.png" width="200">
      </div>

    </div>





    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
    <script src="https://www.amcharts.com/lib/3/gauge.js"></script>


    <script>

      var AASocialIntelAudienceContentInstance = function () {

        var pageDataJS = {"audienceAnalyserVsContent":{"audience":{"personality_name":"Logician","personality_description":"You are somber. You are cautious of others: you are wary of other people&#39;s intentions and do not trust easily. You are self-focused: you are more concerned with taking care of yourself than taking time for others. And you are consistent: you enjoy familiar routines and prefer not to deviate from them. Your choices are driven by a desire for sophistication. You consider both helping others and taking pleasure in life to guide a large part of what you do. You think it is important to take care of the people around you. And you are highly motivated to enjoy life to its fullest.","fullname":"","avatar":"","watson_profile":{"personality":[{"name":"Openness","percentile":0.2825,"children":[{"name":"Adventurousness","percentile":0.4325},{"name":"Artistic interests","percentile":0.66},{"name":"Emotionality","percentile":0.28},{"name":"Imagination","percentile":0.6},{"name":"Intellect","percentile":0.45},{"name":"Authority-challenging","percentile":0.4875}]},{"name":"Conscientiousness","percentile":0.2625,"children":[{"name":"Achievement striving","percentile":0.28},{"name":"Cautiousness","percentile":0.2925},{"name":"Dutifulness","percentile":0.195},{"name":"Orderliness","percentile":0.5725},{"name":"Self-discipline","percentile":0.505},{"name":"Self-efficacy","percentile":0.39}]},{"name":"Extraversion","percentile":0.31,"children":[{"name":"Activity level","percentile":0.3025},{"name":"Assertiveness","percentile":0.515},{"name":"Cheerfulness","percentile":0.6475},{"name":"Excitement-seeking","percentile":0.6775},{"name":"Outgoing","percentile":0.43},{"name":"Gregariousness","percentile":0.4475}]},{"name":"Agreeableness","percentile":0.2325,"children":[{"name":"Altruism","percentile":0.0925},{"name":"Cooperation","percentile":0.2025},{"name":"Modesty","percentile":0.235},{"name":"Uncompromising","percentile":0.3825},{"name":"Sympathy","percentile":0.245},{"name":"Trust","percentile":0.175}]},{"name":"Emotional range","percentile":0.3575,"children":[{"name":"Fiery","percentile":0.6825},{"name":"Prone to worry","percentile":0.5},{"name":"Melancholy","percentile":0.41},{"name":"Immoderation","percentile":0.54},{"name":"Self-consciousness","percentile":0.6225},{"name":"Susceptible to stress","percentile":0.515}]},{"name":"Needs","percentile":0.5,"children":[{"name":"Challenge","percentile":0.6125},{"name":"Closeness","percentile":0.725},{"name":"Curiosity","percentile":0.71},{"name":"Excitement","percentile":0.7675},{"name":"Harmony","percentile":0.6375},{"name":"Ideal","percentile":0.79},{"name":"Liberty","percentile":0.86},{"name":"Love","percentile":0.5225},{"name":"Practicality","percentile":0.5975},{"name":"Self-expression","percentile":0.69},{"name":"Stability","percentile":0.8675},{"name":"Structure","percentile":0.7525}]},{"name":"Values","percentile":0.5,"children":[{"name":"Conservation","percentile":0.5825},{"name":"Openness to change","percentile":0.8675},{"name":"Hedonism","percentile":0.9075},{"name":"Self-enhancement","percentile":0.7},{"name":"Self-transcendence","percentile":0.8575}]}],"needs":[{"name":"Challenge","percentile":0.6125},{"name":"Closeness","percentile":0.725},{"name":"Curiosity","percentile":0.71},{"name":"Excitement","percentile":0.7675},{"name":"Harmony","percentile":0.6375},{"name":"Ideal","percentile":0.79},{"name":"Liberty","percentile":0.86},{"name":"Love","percentile":0.5225},{"name":"Practicality","percentile":0.5975},{"name":"Self-expression","percentile":0.69},{"name":"Stability","percentile":0.8675},{"name":"Structure","percentile":0.7525}],"values":[{"name":"Conservation","percentile":0.5825},{"name":"Openness to change","percentile":0.8675},{"name":"Hedonism","percentile":0.9075},{"name":"Self-enhancement","percentile":0.7},{"name":"Self-transcendence","percentile":0.8575}]}},"content":{"personality_name":"Consul","personality_description":"You are helpful, active and explosive. You are uncompromising: you think it is wrong to take advantage of others to get ahead. You are altruistic: you feel fulfilled when helping others, and will go out of your way to do so. And you are confident: you are hard to embarrass and are self-confident most of the time. Your choices are driven by a desire for belongingness. You are relatively unconcerned with both achieving success and taking pleasure in life. You make decisions with little regard for how they show off your talents. And you prefer activities with a purpose greater than just personal enjoyment.","fullname":"","avatar":"","watson_profile":{"personality":[{"name":"Openness","percentile":0.72,"children":[{"name":"Adventurousness","percentile":0.71},{"name":"Artistic interests","percentile":0.86},{"name":"Emotionality","percentile":0.91},{"name":"Imagination","percentile":0.18},{"name":"Intellect","percentile":0.5},{"name":"Authority-challenging","percentile":0.25}]},{"name":"Conscientiousness","percentile":0.96,"children":[{"name":"Achievement striving","percentile":0.91},{"name":"Cautiousness","percentile":0.85},{"name":"Dutifulness","percentile":0.93},{"name":"Orderliness","percentile":0.72},{"name":"Self-discipline","percentile":0.9},{"name":"Self-efficacy","percentile":0.54}]},{"name":"Extraversion","percentile":0.94,"children":[{"name":"Activity level","percentile":0.84},{"name":"Assertiveness","percentile":0.66},{"name":"Cheerfulness","percentile":0.92},{"name":"Excitement-seeking","percentile":0.08},{"name":"Outgoing","percentile":0.95},{"name":"Gregariousness","percentile":0.9}]},{"name":"Agreeableness","percentile":0.99,"children":[{"name":"Altruism","percentile":0.99},{"name":"Cooperation","percentile":0.99},{"name":"Modesty","percentile":0.94},{"name":"Uncompromising","percentile":0.99},{"name":"Sympathy","percentile":0.98},{"name":"Trust","percentile":0.88}]},{"name":"Emotional range","percentile":0.85,"children":[{"name":"Fiery","percentile":0.06},{"name":"Prone to worry","percentile":0.06},{"name":"Melancholy","percentile":0.18},{"name":"Immoderation","percentile":0.33},{"name":"Self-consciousness","percentile":0.04},{"name":"Susceptible to stress","percentile":0.18}]},{"name":"Needs","percentile":0.5,"children":[{"name":"Challenge","percentile":0.09},{"name":"Closeness","percentile":0.81},{"name":"Curiosity","percentile":0.25},{"name":"Excitement","percentile":0.05},{"name":"Harmony","percentile":0.79},{"name":"Ideal","percentile":0.14},{"name":"Liberty","percentile":0.29},{"name":"Love","percentile":0.47},{"name":"Practicality","percentile":0.08},{"name":"Self-expression","percentile":0.23},{"name":"Stability","percentile":0.23},{"name":"Structure","percentile":0.13}]},{"name":"Values","percentile":0.5,"children":[{"name":"Conservation","percentile":0.68},{"name":"Openness to change","percentile":0.17},{"name":"Hedonism","percentile":0.12},{"name":"Self-enhancement","percentile":0.02},{"name":"Self-transcendence","percentile":0.44}]}],"needs":[{"name":"Challenge","percentile":0.09},{"name":"Closeness","percentile":0.81},{"name":"Curiosity","percentile":0.25},{"name":"Excitement","percentile":0.05},{"name":"Harmony","percentile":0.79},{"name":"Ideal","percentile":0.14},{"name":"Liberty","percentile":0.29},{"name":"Love","percentile":0.47},{"name":"Practicality","percentile":0.08},{"name":"Self-expression","percentile":0.23},{"name":"Stability","percentile":0.23},{"name":"Structure","percentile":0.13}],"values":[{"name":"Conservation","percentile":0.68},{"name":"Openness to change","percentile":0.17},{"name":"Hedonism","percentile":0.12},{"name":"Self-enhancement","percentile":0.02},{"name":"Self-transcendence","percentile":0.44}]}}}};


        var pageId = '';
        var slideDom = $('#report_slide'+pageId);
        console.log("Unique Page ID:", "report_slide"+pageId);
        console.log(pageDataJS);
        var gaugeChart;

        var loadPersonalityOverviewGraph = function(graphID, personalityBreakdownData){

            //-----------------------------------------------------------------------
            //DEVELOPER NOTE!
            //We need to include Needs and Values.
            // this.personality_MO = _addNeedsValues(this.personality_MO);
            //-----------------------------------------------------------------------

            var colorArray = ['#84b761','#fdd400','#cc4748','#67b7dc','#ffaf30','#d88fe8','#bfc442'];
            var bands = [];
            var allLabels = [];
            var bandValue = 100;
            var startY = 3;

            $.each(personalityBreakdownData, function( index, value ) {

                var radius = bandValue;
                var innerRadius = bandValue - 8;

                bands.push({
                  "color": "#eee",
                  "startValue": 0,
                  "endValue": 100,
                  "radius": radius + "%",
                  "innerRadius": innerRadius +"%",
                  "title" : value.name,
                  "dataChild" : value,
                  "colorBandClick" : colorArray[index],
                }, {
                  "color": colorArray[index],
                  "startValue": 0,
                  "endValue": (value.percentile * 100).toFixed(0),
                  "radius": radius+"%",
                  "innerRadius": innerRadius+"%",
                  "balloonText": (value.percentile * 100).toFixed(0) + "%",
                  "title" : value.name,
                  "colorBandClick" : colorArray[index],
                  "dataChild" : value,
                });

                bandValue -= 13;

                allLabels.push({
                  "text": value.name,
                  "x": "49%",
                  "y": startY+"%",
                  "size": 15,
                  "bold": true,
                  "color": colorArray[index],
                  "align": "right"
                });

                startY += 6;

            });

            AmCharts.makeChart(graphID, {
                "type": "gauge",
                "theme": "none",
                "addClassNames": true,
                "axes": [{
                  "axisAlpha": 0,
                  "tickAlpha": 0,
                  "labelsEnabled": false,
                  "startValue": 0,
                  "endValue": 100,
                  "startAngle": 0,
                  "endAngle": 270,
                  "bands": bands,
                }],
                "allLabels": allLabels,
                "export": {
                  "enabled": false
                }
              });

          };



          var loadContentAudienceMatch = function () {

              var id = slideDom.find('#metric_graph').get(0);
              var AudiencePersonality = pageDataJS.audienceAnalyserVsContent.audience;
              var ContentPersonality = pageDataJS.audienceAnalyserVsContent.content;

              if (AudiencePersonality && AudiencePersonality.watson_profile && ContentPersonality && ContentPersonality.watson_profile){
                var tempSum = 0;

                for (i = 0; i < ContentPersonality.watson_profile.personality.length; i++) {          
                  tempSum += parseInt(getPersonalityCalculation(ContentPersonality.watson_profile.personality[i].name))
                  if (tempSum > 0 && ContentPersonality.watson_profile.personality.length) {
                    var valToDisplay = (tempSum/ContentPersonality.watson_profile.personality.length).toFixed(0, 10);

                    // console.clear();
                    // console.log(valToDisplay);

                    setTimeout(function() {
                      gaugeChart.arrows[0].setValue(valToDisplay);
                      gaugeChart.axes[0].setTopText(valToDisplay + " %");
                      gaugeChart.axes[0].bands[1].setEndValue(valToDisplay);

                      setTimeout(function() {
                        $('path').attr('stroke','transparent');
                      },50);

                    },200);

                  }



                }

              }
          };


          var getPersonalityCalculation = function(persName){

            var AudiencePersonality = pageDataJS.audienceAnalyserVsContent.audience;
            var ContentPersonality = pageDataJS.audienceAnalyserVsContent.content;

            if (persName && AudiencePersonality && AudiencePersonality.watson_profile && ContentPersonality && ContentPersonality.watson_profile){          
                //get childrerns for this trait
                for (i = 0; i < ContentPersonality.watson_profile.personality.length; i++) {          
                    if (ContentPersonality.watson_profile.personality[i].name == persName){
                        var dataChild = ContentPersonality.watson_profile.personality[i]
                        var sum = 0;                  
                        $.each(dataChild.children, function( index, value ) {
                            var v1 = getValueForChart(AudiencePersonality, dataChild.name, value.name);
                            var v2 = getValueForChart(ContentPersonality, dataChild.name, value.name);
                            if (v1/v2 > 1) {
                              sum +=  v2/v1
                            } else {
                              sum += v1/v2
                            }
                            //sum += Math.abs(getValueForChart(AudiencePersonality, dataChild.name, value.name) - getValueForChart(ContentPersonality, dataChild.name, value.name))
                            //console.log('one vs other ' + v1 + ' <-->' +  v2)
                        });
                        if (sum > 0) {
                          var value = 100 * (sum/dataChild.children.length)
                          //console.log(value.toFixed(0, 10))
                          return value.toFixed(0, 10)
                        }
                    }
                }
            }
                return 0;
          };


          var getValueForChart = function(profile, category, trait){      
            if (!profile) return 0;
            if (!profile.watson_profile) return 0;
            if (!profile.watson_profile.personality) return 0;

            for (i = 0; i < profile.watson_profile.personality.length; i++) { 
              if (profile.watson_profile.personality[i].name == category){
                for (j = 0; j < profile.watson_profile.personality[i].children.length; j++) { 
                  if (profile.watson_profile.personality[i].children[j].name == trait){
                    return (profile.watson_profile.personality[i].children[j].percentile * 100).toFixed(0);
                  }
                }
              }
            }
            return 0;
          };



        var loadChart = function() {

          gaugeChart = AmCharts.makeChart(metric_graph, {
            "theme": "none",
            "addClassNames": true,
            "type": "gauge",
            "startDuration" : 0,
            "axes": [{
              "topTextFontSize": 20,
              "topTextYOffset": 70,
              "axisColor": "#31d6ea",
              "axisThickness": 1,
              "endValue": 100,
              "gridInside": true,
              "inside": true,
              "radius": "50%",
              "valueInterval": 10,
              "tickColor": "#67b7dc",
              "startAngle": -90,
              "endAngle": 90,
              "unit": "%",
              "bandOutlineAlpha": 0,
              "bands": [{
                "color": "#ce4d4a",
                "endValue": 100,
                "innerRadius": "105%",
                "radius": "170%",
                "startValue": 0
              }, {
                "color": "#87bd40",
                "endValue": 0,
                "innerRadius": "105%",
                "radius": "170%",
                "startValue": 0
              }]
            }],
            "arrows": [{
              "alpha": 1,
              "innerRadius": "35%",
              "nailRadius": 0,
              "radius": "170%"
            }]
          });

        };


        return {
            init: function () {
              loadChart();

              loadPersonalityOverviewGraph(slideDom.find('#gauge1_graph').get(0), pageDataJS.audienceAnalyserVsContent.audience.watson_profile.personality);
              loadPersonalityOverviewGraph(slideDom.find('#gauge2_graph').get(0), pageDataJS.audienceAnalyserVsContent.content.watson_profile.personality);
              
              loadContentAudienceMatch();


              setTimeout(function() {
                $('path').attr('stroke','transparent');
              },50);
            }
        };
        
      }();

      AASocialIntelAudienceContentInstance.init();
          
    </script>


  </body>
</html>
